# Action Streams Template Author Guide #

The Action Streams plugin provides a full suite of template tags for
publishing action stream data however you wish.

## Examples ##

See both the examples provided in the
`plugins/ActionStreams/doc/example_templates` directory, as well as the
default template set in `plugins/ActionStreams/blog_tmpl` for a turnkey
solution you can disassemble.

## The minimal list ##

The simplest way to list actions is to use the markup provided by the recipe
authors with the `mt:StreamAction` tag. To list the most recent actions by all
a blog's authors, use the template code:

    <ul>
        <mt:ActionStreams>
            <li><mt:StreamAction></li>
        </mt:ActionStreams>
    </ul>

Action Streams also provides CSS and service icons for showing from what
service each action came from. If you include that CSS, use the
`action-streams` and `service-icon` classes, as in this markup:

    <!-- inside the <head> -->
    <link rel="stylesheet" type="text/css"
        href="<mt:StaticWebPath>plugins/ActionStreams/css/action-streams.css">
    <!-- styles for any extra Action Stream plugins you install -->
    <style type="text/css">
        <mt:ProfileServices extra="1"><mt:if name="icon_url">
        .service-<mt:var name="type"> {
            background-image: url(<mt:var name="icon_url">);
        }
        </mt:if></mt:ProfileServices>
    </style>

    <!-- in your list -->
    <div class="action-streams">
        <ul class="action-streams-list">
            <mt:ActionStreams>
            <li class="service-icon service-<mt:var name="service_type">">
                <mt:StreamAction>
            </li>
            </mt:ActionStreams>
        </ul>
    </div>

This will show all the icons for the plugin's known profile services on the
published actions.

## Custom templates ##

Sometimes the default `<mt:StreamAction>` output doesn't fit, and you want to
specify the markup yourself. You might be making a recent photos widget, using
`<mt:ActionStreams stream="photos">` to list only photos, in which case you'd
want to show only the thumbnails from those actions, not the wordy text you
get from `<mt:StreamAction>`.

You can fully specify the markup used for actions using the other template
tags supplied by the plugin. In a recent photos widget, you might want to show
only linked thumbnails. You would write in your template:

    <div class="widget-photos">
        <h3>Recent Photos</h3>
        
        <ul>
        <mt:ActionStreams stream="photos">
        <li>
            <a href="<mt:StreamActionURL>"
                title="<mt:StreamActionTitle escape="html">">
                <img src="<mt:StreamActionThumbnailURL>"></a>
        </li>
        </mt:ActionStreams>
        </ul>
    </div>

See later in this document for documentation on the provided template tags.

## Customizing based on type ##

You may also want to customize only *some* action templates. For example, you
might use Google Reader's sharing feature to keep a feed of your favorite
podcasts. By default, those actions would show up as:

    <li>
        Melody shared <a href="...">Favorite Podcast episode #7</a>
        from <a href="...">Favorite Podcast</a>
    </li>

Instead, you could *conditionally* use different template code for those
Google Reader actions, using the `<mt:If>` tag:

    <mt:ActionStreams>
        <li>
        <mt:If name="action_type" eq="googlereader_shared">
            <mt:AuthorDisplayName escape="html">
            saved <a href="<mt:StreamActionURL escape="html">">
                <mt:StreamActionTitle escape="html">
            </a>
            as a favorite episode of
            <a href="<mt:StreamActionVar name="source_url" escape="html">">
                <mt:StreamActionVar name="source_title" escape="html">
            </a>
        <mt:Else>
            <mt:StreamAction>
        </mt:If>
        </li>
    </mt:ActionStreams>

Then all your shared Google Reader items will be customized, but your Digg
links and Flickr photos will display as normal. You can customize multiple
actions by specifying test attributes on another `<mt:Else>` tag:

    <mt:If name="action_type" eq="googlereader_shared">
        <!-- shared on google reader -->
    <mt:Else name="action_type" eq="digg_links">
        <!-- dugg on digg -->
    <mt:Else>
        <!-- everything else -->
    </mt:If>

See the documentation for `<mt:ActionStreams>` for the variables it sets to
help you customize your templates.

## Rolling actions up ##

## Tag reference ##

### Selecting authors ###

Both the `mt:ActionStreams` and `mt:OtherProfiles` tags for listing actions
and profiles respectively take several options for picking whose actions or
profiles to show.

If one of the below author selecting attributes is used, it specifies the
authors. Otherwise, if the tag is used in an author context (such as on an
author archive page, inside an `mt:Authors` tag, or in an entry context), that
one author is selected. Otherwise, if the tag is used in a blog context (most
of the time), all the authors on that blog are selected.

The tag attributes for selecting authors are:

#### `author_ids` ####

A list of the numeric IDs of authors to select, separated by commas.

#### `display_names` ####

A list of the full display names of authors to select, separated by commas.

#### `authors` ####

A list of the login usernames of authors to select, separated by commas.

### `mt:ProfileServices` ###

### `mt:OtherProfiles` ###

### `mt:OtherProfileVar` ###

### `mt:ActionStreams` ###

Loops over the actions selected by the author context and specified
attributes. See "Selecting authors" above.

Inside the `mt:ActionStreams` loop, an action context where you can use the
other `mt:StreamAction`*`Something`* tags is provided.

The attributes supported by this tag are:

#### `sort_by` ####

The field by which to order the selected actions. By default, actions are
ordered by the `created_on` field (that is, the time when the action occurred
or was first found). You cannot sort by any of your streams' additional
fields, even when limiting actions to those streams.

#### `direction` ####

The direction in which to order the selected actions. Possible values are
`descend` and `ascend`. By default, actions are ordered in descending order
(`descend`).

#### `limit` ####

The number of actions at most to show. If fewer actions are available in the
selected set of actions, fewer will be shown.

#### `days` ####

The number of days of actions at most to show, as determined at publish time
from the actions' creation times (`created_on` fields). If fewer actions are
available in the selected set of actions, fewer will be shown.

#### `service` ####

The ID of the service from which to show actions. Service IDs are the keys
used in their service definitions; for example, Twitter's ID is `twitter`, and
del.icio.us' ID is `delicious`.

For services with multiple streams, limiting only by `service` without a
`stream` will list all actions from all of those streams. For example,
`service="flickr"` will list both Flickr photos and Flickr favorites.

#### `stream` ####

The ID of the stream from which to show actions. Stream IDs are the keys used
in their recipe definitions; for example, the stream of del.icio.us links has
the ID `links`, and the stream of Flickr photos has the ID `photos`.

Because similar streams for all services use the same stream IDs, you can use
the `stream` attribute independent of `service` to slice for similar actions
across services. For example, you can specify `stream="photos"` to get photo
events across services, or `stream="favorites"` for a multi-source list of
favorites.

To list actions from one particular stream only, use both `service` and
`stream`.

### `mt:StreamAction` ###

Provides the recipe authors' suggested markup for the action in context.

### `mt:StreamActionVar` ###

### `mt:StreamActionTitle` ###

### `mt:StreamActionURL` ###

### `mt:StreamActionThumbnailURL` ###

### `mt:StreamActionDate` ###

### `mt:StreamActionModifiedDate` ###

### `mt:StreamActionTags` ###

### `mt:StreamActionRollup` ###
